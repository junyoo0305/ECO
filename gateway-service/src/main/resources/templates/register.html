<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>íšŒì› ê°€ì… - ê¸°ì—… ì¬ìƒì—ë„ˆì§€ ì§€ì›ì„¼í„°</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --primary-blue: #2563eb; /* ë©”ì¸ í˜ì´ì§€ì˜ ë°ì€ íŒŒë€ìƒ‰ */
            --primary-dark: #1e3a8a; /* ë¡œê³  ìƒ‰ìƒ (ë„¤ì´ë¹„) */
            --primary-light: #eff6ff; /* ë°°ê²½ìš© ì—°í•œ í•˜ëŠ˜ìƒ‰ */
            --accent-green: #22c55e; /* ì»¨ì„¤íŒ… ì¹´ë“œ ìƒ‰ìƒ (í¬ì¸íŠ¸) */
            --text-color: #333333;
        }

        body {
            background-color: #f3f6fc; /* ì•„ì£¼ ì—°í•œ í‘¸ë¥¸ë¹›ì´ ë„ëŠ” íšŒìƒ‰ */
            font-family: 'Noto Sans KR', sans-serif;
            color: var(--text-color);
        }

        .container {
            max-width: 600px; /* í¼ ë„ˆë¹„ë¥¼ ì¡°ê¸ˆ ë” ë„“í˜€ ì‹œì›í•˜ê²Œ */
        }

        .register-container {
            margin: 60px auto;
            padding: 40px;
            background-color: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0, 52, 166, 0.08); /* íŒŒë€ë¹›ì´ ë„ëŠ” ê·¸ë¦¼ì */
            border-top: 5px solid var(--primary-blue); /* ìƒë‹¨ í¬ì¸íŠ¸ ì»¬ëŸ¬ */
        }

        .register-title {
            text-align: center;
            margin-bottom: 10px;
            color: var(--primary-dark);
            font-weight: 700;
            font-size: 28px;
        }

        .register-subtitle {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 30px;
        }

        /* ì„¹ì…˜ ì œëª© ìŠ¤íƒ€ì¼ */
        h4.register-title {
            text-align: left;
            font-size: 18px;
            margin-top: 30px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            color: var(--primary-dark);
        }

        h4.register-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 18px;
            background-color: var(--primary-blue);
            margin-right: 10px;
            border-radius: 2px;
        }

        hr {
            border-top: 1px solid #e1e4e8;
            margin-bottom: 25px;
        }

        /* í¼ ì»¨íŠ¸ë¡¤ ë””ìì¸ */
        .form-label {
            font-weight: 500;
            font-size: 14px;
            color: #4b5563;
        }

        .form-control, .form-select {
            border-radius: 8px;
            padding: 12px;
            border: 1px solid #d1d5db;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        /* íšŒì› ìœ í˜• ë¼ë””ì˜¤ ë²„íŠ¼ -> ì¹´ë“œí˜• ì„ íƒìœ¼ë¡œ ë³€ê²½ CSS */
        .type-selector {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .type-option {
            flex: 1;
            position: relative;
        }

        .type-option input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
        }

        .type-option label {
            display: block;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            text-align: center;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            color: #9ca3af;
            background-color: #f9fafb;
        }

        /* ì„ íƒë˜ì—ˆì„ ë•Œ ìŠ¤íƒ€ì¼ */
        .type-option input:checked + label {
            border-color: var(--primary-blue);
            background-color: var(--primary-light);
            color: var(--primary-blue);
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), #1d4ed8);
            border: none;
            padding: 14px;
            font-weight: 600;
            border-radius: 8px;
            font-size: 16px;
            transition: transform 0.2s;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #1d4ed8, var(--primary-dark));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary, .btn-outline-secondary, .btn-outline-primary {
            border-radius: 8px;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 500;
        }

        .btn-outline-primary {
            color: var(--primary-blue);
            border-color: var(--primary-blue);
        }

        .btn-outline-primary:hover {
            background-color: var(--primary-blue);
            color: white;
        }

        /* d-flex gap-2 ë†’ì´ ë§ì¶¤ */
        .d-flex.gap-2 {
            align-items: stretch;
        }

        #sellComId { flex: 1; }
        #checkIdBtn, #sendEmailBtn, #verifyEmailBtn { min-width: 90px; }

        /* ë¹„ë°€ë²ˆí˜¸ ê·œì¹™ ìŠ¤íƒ€ì¼ */
        .pw-rules {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding-left: 0;
            margin-top: 8px;
            list-style: none;
            font-size: 12px;
        }

        .pw-rules li {
            color: #9ca3af;
            background-color: #f3f4f6;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }

        .pw-rules li.valid {
            color: #fff;
            background-color: var(--accent-green); /* ì¡°ê±´ ì¶©ì¡± ì‹œ ì´ˆë¡ìƒ‰ */
            font-weight: bold;
        }

        /* ë§í¬ ìŠ¤íƒ€ì¼ */
        .login-link {
            text-align: center;
            margin-top: 25px;
            font-size: 14px;
        }

        .login-link a {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 600;
        }

        .login-link a:hover {
            text-decoration: underline;
        }

        .form-check-input:checked {
            background-color: var(--primary-blue);
            border-color: var(--primary-blue);
        }

        /* ì˜¤ë¥˜/ì„±ê³µ ë©”ì‹œì§€ */
        #id-error, #pwMessage, #email-msg {
            margin-top: 5px;
            font-weight: 500;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="register-container">
        <h2 class="register-title">ê¸°ì—… ì¬ìƒì—ë„ˆì§€ ì§€ì›ì„¼í„°</h2>
        <p class="register-subtitle">ì•ˆì „í•˜ê³  íˆ¬ëª…í•œ ì¬ìƒì—ë„ˆì§€ ê±°ë˜ì˜ ì‹œì‘</p>

        <form id="registerForm">
            <div class="mb-4">
                <label class="form-label">ê°€ì… ìœ í˜•ì„ ì„ íƒí•´ì£¼ì„¸ìš”</label>
                <div class="type-selector">
                    <div class="type-option">
                        <input type="radio" name="companyType" id="typeBuyer" value="BUYER" checked>
                        <label for="typeBuyer">êµ¬ë§¤ì</label>
                    </div>
                    <div class="type-option">
                        <input type="radio" name="companyType" id="typeSeller" value="SELLER">
                        <label for="typeSeller">íŒë§¤ì</label>
                    </div>
                </div>
            </div>

            <h4 class="register-title">ê¸°ì—… ì •ë³´</h4>
            <hr>
            <div class="mb-3">
                <label for="sellComName" class="form-label">ì‚¬ì—…ìëª…</label>
                <input type="text" class="form-control" id="sellComName" placeholder="ì‚¬ì—…ìë“±ë¡ì¦ ìƒì˜ ìƒí˜¸ëª…" name="sellComName" required>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="sellRegNum" class="form-label">ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸</label>
                    <input type="text" class="form-control" id="sellRegNum" placeholder="- ì—†ì´ 10ìë¦¬ ìˆ«ì" maxlength="10" name="sellRegNum" required>
                </div>
                <div class="col-md-6">
                    <label for="sellRepName" class="form-label">ëŒ€í‘œì ì„±ëª…</label>
                    <input type="text" class="form-control" id="sellRepName" placeholder="ëŒ€í‘œì ì„±ëª…" name="sellRepName" required>
                </div>
            </div>

            <div class="mb-3">
                <label for="sellComBirth" class="form-label">ê°œì—… ì¼ì</label>
                <input type="text" class="form-control" id="sellComBirth" placeholder="YYYYMMDD (ì˜ˆ: 20240101)" name="sellComBirth" maxlength="8" required>
            </div>

            <div class="mb-3">
                <label for="sellComAdr" class="form-label">íšŒì‚¬ ì£¼ì†Œ</label>
                <input type="text" class="form-control" id="sellComAdr" placeholder="ë„ë¡œëª… ì£¼ì†Œ ì…ë ¥" name="sellComAdr" required>
            </div>

            <div class="mb-3">
                <label class="form-label">íšŒì‚¬ ì „í™”ë²ˆí˜¸</label>
                <div class="d-flex gap-2">
                    <select class="form-select" id="sellComNumPrefix" style="max-width: 100px;">
                        <option value="02">02</option>
                        <option value="031">031</option>
                        <option value="032">032</option>
                        <option value="051">051</option>
                        <option value="010">010</option>
                    </select>
                    <input type="text" class="form-control" id="sellComNum" placeholder="12345678" maxlength="8" required>
                </div>
            </div>

            <h4 class="register-title">ë‹´ë‹¹ì ì •ë³´</h4>
            <hr>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="sellBmName" class="form-label">ë‹´ë‹¹ì ì´ë¦„</label>
                    <input type="text" class="form-control" id="sellBmName" placeholder="ì‹¤ë¬´ ë‹´ë‹¹ì ì„±ëª…" name="sellBmName" required>
                </div>
                <div class="col-md-6">
                    <label for="sellBmDep" class="form-label">ë‹´ë‹¹ì ë¶€ì„œ</label>
                    <input type="text" class="form-control" id="sellBmDep" placeholder="ì†Œì† ë¶€ì„œ" name="sellBmDep" required>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">ë‹´ë‹¹ì íœ´ëŒ€ì „í™”</label>
                <div class="d-flex gap-2">
                    <select class="form-select" id="sellBmNumPrefix" style="max-width: 100px;">
                        <option value="010" selected>010</option>
                        <option value="011">011</option>
                    </select>
                    <input type="text" class="form-control" id="sellBmNum" placeholder="íœ´ëŒ€ì „í™” ë²ˆí˜¸ ì…ë ¥" maxlength="8" required>
                </div>
            </div>

            <h4 class="register-title">ê³„ì • ì •ë³´</h4>
            <hr>

            <div class="mb-3">
                <label for="sellComId" class="form-label">ì•„ì´ë””</label>
                <div class="d-flex gap-2">
                    <input type="text" class="form-control" id="sellComId" placeholder="ì˜ë¬¸, ìˆ«ì í¬í•¨ 3~15ì" required pattern="^[A-Za-z0-9]{3,15}$">
                    <button type="button" class="btn btn-dark" id="checkIdBtn">ì¤‘ë³µ í™•ì¸</button>
                </div>
                <div id="id-error" style="color:red; font-size:12px;"></div>
            </div>

            <div class="mb-3">
                <label for="sellComPw" class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" class="form-control" id="sellComPw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" name="sellComPw" required pattern="^[A-Za-z0-9!@#$%^&*]{8,30}$">

                <ul id="pwRules" class="pw-rules">
                    <li id="rule-length">8~30ì</li>
                    <li id="rule-letter">ì˜ë¬¸</li>
                    <li id="rule-number">ìˆ«ì</li>
                    <li id="rule-special">íŠ¹ìˆ˜ë¬¸ì</li>
                </ul>

                <input type="password" class="form-control mt-2" id="sellComPwConfirm" placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥" required />
                <div id="pwMessage" style="font-size:12px; color:red;"></div>
            </div>

            <div class="mb-3">
                <label for="sellComEmail" class="form-label">ì´ë©”ì¼ ì¸ì¦</label>
                <div class="d-flex gap-2 mb-2">
                    <input type="email" class="form-control" id="sellComEmail" placeholder="ì—…ë¬´ìš© ì´ë©”ì¼ ì£¼ì†Œ" required>
                    <button type="button" class="btn btn-outline-primary" id="sendEmailBtn">ì¸ì¦ ìš”ì²­</button>
                </div>

                <div class="d-flex gap-2">
                    <input type="text" class="form-control" id="emailCode" placeholder="ì¸ì¦ë²ˆí˜¸ 6ìë¦¬" maxlength="6" readonly>
                    <button type="button" class="btn btn-primary" id="verifyEmailBtn">í™•ì¸</button>
                </div>
                <div id="email-msg" style="font-size:12px;"></div>
            </div>

            <h4 class="register-title">ì•½ê´€ ë™ì˜</h4>
            <hr>

            <div class="card p-3 bg-light border-0 mb-4">
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" id="termsCheck" required>
                    <label class="form-check-label" for="termsCheck">
                        [í•„ìˆ˜] <a href="terms.html" target="_blank" style="color:var(--primary-blue); font-weight:bold;">ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€</a>ì— ë™ì˜í•©ë‹ˆë‹¤.
                    </label>
                </div>
                <div class="form-check mb-2">
                    <input type="checkbox" class="form-check-input" id="privacyCheck" required>
                    <label class="form-check-label" for="privacyCheck">
                        [í•„ìˆ˜] <a href="privacy.html" target="_blank" style="color:var(--primary-blue); font-weight:bold;">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</a>ì— ë™ì˜í•©ë‹ˆë‹¤.
                    </label>
                </div>
                <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="marketingCheck">
                    <label class="form-check-label" for="marketingCheck">
                        [ì„ íƒ] <a href="marketing.html" target="_blank" style="color:#666;">ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹ </a>ì— ë™ì˜í•©ë‹ˆë‹¤.
                    </label>
                </div>
            </div>

            <div class="d-grid mt-5">
                <button type="submit" class="btn btn-primary btn-register btn-lg">íšŒì›ê°€ì… ì™„ë£Œ</button>
            </div>

            <div class="login-link">
                ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? <a href="/login">ë¡œê·¸ì¸í•˜ê¸°</a>
            </div>
        </form>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // ê¸°ì¡´ ìŠ¤í¬ë¦½íŠ¸ ê¸°ëŠ¥ 100% ìœ ì§€
    const sellComIdInput = document.getElementById('sellComId');
    const idError = document.getElementById('id-error');
    const checkIdBtn = document.getElementById('checkIdBtn');
    const registerForm = document.getElementById('registerForm');
    const idRegex = /^[A-Za-z0-9]{3,15}$/;

    let isIdChecked = false;

    const emailInput = document.getElementById('sellComEmail');
    const sendEmailBtn = document.getElementById('sendEmailBtn');
    const verifyEmailBtn = document.getElementById('verifyEmailBtn');
    const emailCodeInput = document.getElementById('emailCode');
    const emailMsg = document.getElementById('email-msg');

    let isEmailVerified = false;

    const pw = document.getElementById("sellComPw");
    const pwConfirm = document.getElementById("sellComPwConfirm");
    const msg = document.getElementById("pwMessage");

    const pwInput = document.getElementById('sellComPw');

    const ruleLength = document.getElementById('rule-length');
    const ruleLetter = document.getElementById('rule-letter');
    const ruleNumber = document.getElementById('rule-number');
    const ruleSpecial = document.getElementById('rule-special');

    const termsCheck = document.getElementById('termsCheck');
    const privacyCheck = document.getElementById('privacyCheck');

    pwInput.addEventListener('input', function () {
        const value = pwInput.value;
        // 8~30ì
        toggleRule(ruleLength, value.length >= 8 && value.length <= 30);
        // ì˜ë¬¸ ëŒ€ì†Œë¬¸ì
        toggleRule(ruleLetter, /[A-Za-z]/.test(value));
        // ìˆ«ì
        toggleRule(ruleNumber, /[0-9]/.test(value));
        // íŠ¹ìˆ˜ë¬¸ì
        toggleRule(ruleSpecial, /[!@#$%^&*]/.test(value));
    });

    function toggleRule(element, condition) {
        if (condition) {
            element.classList.add('valid');
        } else {
            element.classList.remove('valid');
        }
    }

    // ğŸ”¹ ì•„ì´ë”” ì¤‘ë³µ í™•ì¸ ë²„íŠ¼
    checkIdBtn.addEventListener('click', async () => {
        const sellComId = sellComIdInput.value.trim();
        idError.textContent = '';
        idError.style.color = 'red';
        isIdChecked = false;

        if (!sellComId) {
            idError.textContent = 'ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
            return;
        }
        if (!idRegex.test(sellComId)) {
            idError.textContent = 'ì•„ì´ë””ëŠ” 3~15ì ì˜ë¬¸, ìˆ«ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.';
            sellComIdInput.focus();
            return;
        }

        try {
            const res = await fetch(`/api/auth/check-id?sellComId=${sellComId}`);
            const exists = await res.json();

            if (exists) {
                idError.textContent = 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ì•„ì´ë””ì…ë‹ˆë‹¤.';
                sellComIdInput.value = '';
                sellComIdInput.focus();
            } else {
                idError.style.color = '#22c55e'; // ì„±ê³µ ì‹œ ì´ˆë¡ìƒ‰ (Green)
                idError.textContent = 'ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë””ì…ë‹ˆë‹¤.';
                isIdChecked = true;
            }
        } catch (e) {
            idError.textContent = 'ì¤‘ë³µ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
        }
    });

    // ğŸ”¹ ì•„ì´ë”” ì…ë ¥ê°’ ë³€ê²½ ì‹œ ë‹¤ì‹œ ì¤‘ë³µ í™•ì¸ í•„ìš”
    sellComIdInput.addEventListener('input', () => {
        isIdChecked = false;
        idError.textContent = '';
    });

    // ğŸ”¹ íšŒì›ê°€ì… submit ì‹œ ì¤‘ë³µ í™•ì¸ ì—¬ë¶€ ê²€ì‚¬
    registerForm.addEventListener('submit', async function(e) {
        e.preventDefault();

        // í•„ìˆ˜ ì•½ê´€ ë™ì˜ í™•ì¸
        if (!termsCheck.checked) {
            alert('ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
            termsCheck.focus();
            return;
        }
        if (!privacyCheck.checked) {
            alert('ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
            privacyCheck.focus();
            return;
        }

        // ê°œì—…ì¼ì, ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸, íšŒì‚¬ ì „í™”ë²ˆí˜¸, ë‹´ë‹¹ì ì „í™”ë²ˆí˜¸ í¬ê¸°
        if (document.getElementById('sellRegNum').value.length !== 10) {
            alert('ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸ëŠ” 10ìë¦¬ì…ë‹ˆë‹¤.');
            document.getElementById('sellRegNum').focus();
            return;
        }
        if (document.getElementById('sellComNum').value.length < 7) {
            alert('íšŒì‚¬ ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            document.getElementById('sellComNum').focus();
            return;
        }
        if (document.getElementById('sellBmNum').value.length < 7) {
            alert('ë‹´ë‹¹ì ì „í™”ë²ˆí˜¸ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            document.getElementById('sellBmNum').focus();
            return;
        }
        if (document.getElementById('sellComBirth').value.length !== 8) {
            alert('ê°œì—…ì¼ìëŠ” 19990101 í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            document.getElementById('sellComBirth').focus();
            return;
        }

        if (!isIdChecked) {
            idError.style.color = 'red';
            idError.textContent = 'ì•„ì´ë”” ì¤‘ë³µ í™•ì¸ì„ í•´ì£¼ì„¸ìš”.';
            sellComIdInput.focus();
            return;
        }

        // ë¹„ë°€ë²ˆí˜¸ ê²€ì¦ ì¶”ê°€
        if (!checkPasswordMatch()) {
            pwConfirm.focus();
            return;
        }

        if (!checkPasswordStrength(pw.value)) {
            msg.textContent = 'ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ìë¥¼ ëª¨ë‘ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.';
            msg.style.color = 'red';
            pw.focus();
            return;
        }

        // ì´ë©”ì¼ ì¸ì¦ í™•ì¸
        if (!isEmailVerified) {
            emailMsg.style.color = 'red';
            emailMsg.textContent = 'ì´ë©”ì¼ ì¸ì¦ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.';
            emailInput.focus();
            return;
        }

        // êµ¬ë§¤ì íŒë§¤ì ì„ íƒ
        const companyType = document.querySelector(
            'input[name="companyType"]:checked'
        ).value;

        const sellComNum =
            document.getElementById('sellComNumPrefix').value
            + '-' +
            document.getElementById('sellComNum').value;
        const sellBmNum =
            document.getElementById('sellBmNumPrefix').value
            + '-' +
            document.getElementById('sellBmNum').value;

        const payload = {
            companyType, // ì¶”ê°€
            sellComName: document.getElementById('sellComName').value, // ì‚¬ì—…ìëª…
            sellRegNum: document.getElementById('sellRegNum').value, // ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸
            sellRepName: document.getElementById('sellRepName').value, // ëŒ€í‘œì ì„±ëª…
            sellComBirth: document.getElementById('sellComBirth').value, // ê°œì—…ì¼ì
            sellComAdr: document.getElementById('sellComAdr').value, // íšŒì‚¬ ì£¼ì†Œ
            sellComNum, // íšŒì‚¬ ì „í™”ë²ˆí˜¸
            sellBmName: document.getElementById('sellBmName').value, // ë‹´ë‹¹ì ì„±ëª…
            sellBmNum, // ë‹´ë‹¹ì ì „í™”ë²ˆí˜¸
            sellBmDep: document.getElementById('sellBmDep').value, // ë‹´ë‹¹ì ë¶€ì„œ
            sellComId: sellComIdInput.value, // Id
            sellComPw: pw.value, // Password
            sellComPwConfirm: pwConfirm.value, // ë¹„ë°€ë²ˆí˜¸ í™•ì¸
            sellComEmail: emailInput.value, // Email
            marketingCheck: document.getElementById('marketingCheck').checked ? "Y" : "N" //ë§ˆì¼€íŒ… ì´ìš©ì•½ê´€ ì²´í¬ ì—¬ë¶€
        };

        try {
            const response = await fetch('/api/auth/register', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (response.ok) {
                alert('íšŒì› ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                window.location.href = '/login';
            } else {
                const error = await response.text();
                alert('íšŒì› ê°€ì… ì‹¤íŒ¨: ' + error);
            }
        } catch (err) {
            alert('íšŒì› ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    });

    // ì „í™”ë²ˆí˜¸ ìˆ«ìë§Œ ë„£ìœ¼ì„¸ìš”
    function allowOnlyNumbers(input) {
        input.addEventListener('input', () => {
            input.value = input.value.replace(/[^0-9]/g, '');
        });
    }

    // ê°ê° ê°œì—…ì¼ì, ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸, íšŒì‚¬ ì „í™”ë²ˆí˜¸, ë‹´ë‹¹ì ì „í™”ë²ˆí˜¸
    allowOnlyNumbers(document.getElementById('sellComBirth'));
    allowOnlyNumbers(document.getElementById('sellRegNum'));
    allowOnlyNumbers(document.getElementById('sellComNum'));
    allowOnlyNumbers(document.getElementById('sellBmNum'));

    // ë¹„ë°€ë²ˆí˜¸ ì œì•½ ì¡°ê±´ í™•ì¸ìš©
    function checkPasswordStrength(password) {
        const hasLetter = /[A-Za-z]/.test(password);
        const hasNumber = /[0-9]/.test(password);
        const hasSpecial = /[!@#$%^&*]/.test(password);
        const validLength = password.length >= 8 && password.length <= 30;

        return hasLetter && hasNumber && hasSpecial && validLength;
    }

    function checkPasswordMatch() {
        if (!pw.value || !pwConfirm.value) {
            msg.textContent = "";
            return false;
        }
        if (pw.value !== pwConfirm.value) {
            msg.textContent = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.";
            msg.style.color = "red";
            return false;
        } else {
            msg.textContent = "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.";
            msg.style.color = "#22c55e"; // ì„±ê³µ ì‹œ ì´ˆë¡
            return true;
        }
    }

    pw.addEventListener("keyup", checkPasswordMatch);
    pwConfirm.addEventListener("keyup", checkPasswordMatch);

    // ì¸ì¦ ë©”ì¼ ì „ì†¡
    sendEmailBtn.addEventListener('click', async () => {
        const email = emailInput.value.trim();
        emailMsg.textContent = '';
        isEmailVerified = false;

        if (!email) {
            emailMsg.textContent = 'ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”.';
            emailMsg.style.color = 'red';
            return;
        }

        try {
            const res = await fetch('/api/auth/email/send', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    email
                })
            });

            if (!res.ok) {
                emailMsg.textContent = 'ì´ë©”ì¼ ì „ì†¡ ì‹¤íŒ¨';
                emailMsg.style.color = 'red';
                return;
            }

            const data = await res.json(); // { code }

            // ë‚´ë¶€ì ìœ¼ë¡œ ì¸ì¦ë²ˆí˜¸ ì €ì¥
            emailCodeInput.value = data.code;
            emailCodeInput.readOnly = true;

            // ğŸ”¹ alertì°½ ë„ìš°ê¸°
            alert('ì¸ì¦ë²ˆí˜¸ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ í™•ì¸í•˜ì„¸ìš”.');

            // ìƒíƒœ ë©”ì‹œì§€
            emailMsg.textContent = 'ì¸ì¦ë²ˆí˜¸ê°€ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.';
            emailMsg.style.color = '#2563eb'; // íŒŒë€ìƒ‰
        } catch (err) {
            emailMsg.textContent = 'ì´ë©”ì¼ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            emailMsg.style.color = 'red';
        }
    });

    // ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸
    verifyEmailBtn.addEventListener('click', async () => {
        const email = emailInput.value.trim();
        const code = emailCodeInput.value.trim();

        const res = await fetch('/api/auth/email/verify', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email,
                code
            })
        });

        if (res.ok) {
            emailMsg.textContent = 'ì´ë©”ì¼ ì¸ì¦ ì™„ë£Œ';
            emailMsg.style.color = '#22c55e'; // ì´ˆë¡
            isEmailVerified = true;

            verifyEmailBtn.disabled = true;
            verifyEmailBtn.className = 'btn btn-success'; // ë²„íŠ¼ ìƒ‰ìƒ ë³€ê²½
        } else {
            emailMsg.textContent = 'ì¸ì¦ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
            emailMsg.style.color = 'red';
            isEmailVerified = false;
        }
    });

</script>
</body>
</html>